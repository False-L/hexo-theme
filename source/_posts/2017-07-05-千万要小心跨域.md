---
title: 千万要小心跨域
description: 昨天在跨域上传上着了道
date: 2017-07-05 19:09:22
categories: [技术]
tags:
- fetch
- upload
- 文件上传
---
在跨域上传文件时，post到服务器，是会先发送一个options的请求，服务器返回200或204时，浏览器才会继续上传文件，但是这个options的请求时无论如何也无法带上cookie的，这时候如果服务器时代cookie验证的，那么请求就会被拒绝（很不巧，目前的项目就是服务器端任何请求都带cookie验证的。。），结果我每次上传都是返回的302，返回请求带的cookie也和请求的不同。   
解决办法： 服务器端对options请求做处理，不进行session验证。
<!--more-->
最近上班，一直都在做项目，维护项目，写日志的次数少了很多。。